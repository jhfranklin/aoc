âŸ¨Split,Nat,_fixâŸ©â†â€¢Import "utils.bqn"

mâ†1âŠ¸â†“âŒ¾(âŠ‘âŒ½)Ë˜ >':'âŠ¸SplitÂ¨ â€¢FLines "21.in"

Calcâ†{ğ•Š name:
  iâ†âŠ‘(âŠâ‰m)âŠ<name
  fâ†' 'Split âŠ‘i(1âŠ¸â†“âŠ)m
  (1=â‰ f)â—¶âŸ¨{ğ•Š aâ€¿opâ€¿b: (Calc a) ((âŠ‘"+-/*"âŠ¸âŠ)op)â—¶âŸ¨+,-,Ã·,Ã—âŸ© Calc b},Natâˆ˜âŠ‘âŸ© f
}

â€¢Show Calc "root"

_Calc2â†{humn _ğ•£ "humn": humn;
  humn _ğ•£ "root": -â—‹(humn _Calc2)Â´ (âŠ‘â‹ˆâŠ‘âˆ˜âŒ½)râ†' 'Split âŠ‘m(1âŠ¸â†“âŠ)ËœâŠ‘(âŠâ‰m)âŠ<"root";
  humn _ğ•£ name:
  iâ†âŠ‘(âŠâ‰m)âŠ<name
  fâ†' 'Split âŠ‘i(1âŠ¸â†“âŠ)m
  (1=â‰ f)â—¶âŸ¨{ğ•Š aâ€¿opâ€¿b: (humn _Calc2 a) ((âŠ‘"+-/*"âŠ¸âŠ)op)â—¶âŸ¨+,-,Ã·,Ã—âŸ© humn _Calc2 b},Natâˆ˜âŠ‘âŸ© f
}

_secantâ†{ğ”½ _ğ•£ xn1â€¿xn2:
  xnâ†((xn2Ã—ğ”½ xn1)-xn1Ã—ğ”½ xn2)Ã·xn1 -â—‹ğ”½ xn2
  (xnâ‰ xn1)â—¶âŸ¨xn,xnâ€¿xn1âŸ©@;
  ğ”½ _ğ•£ xn: xn
}
â€¢Show âŠ‘({ğ•© _Calc2 "root"} _secant)_fix 1â€¿2
