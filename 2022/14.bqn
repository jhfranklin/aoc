âŸ¨Nat,Nats,_fix,_while_âŸ©â†â€¢Import "utils.bqn"
inâ†â€¢FLines "14.in"
Toâ†{â¥Šâ‹ˆâŒœÂ´(ğ•¨âŒŠğ•©)+â†•Â¨1+|ğ•¨-ğ•©} 
rockâ† âŒ½Â¨â·âˆ¾Â´{âˆ¾Â´ToÂ´Â¨<Ë˜âŠâ‰Â¯2 2â†•â‹ˆË˜âˆ˜â€¿2â¥ŠNats ğ•©}Â¨ in
lowâ†âŒˆÂ´âŠ‘Â¨rock
fullâ†rock
sandstartâ†0â€¿500
Dropâ†{ğ•Š full:
  newâ†{ğ•Š sand:
    belowâ†âŸ¨1â€¿0,1â€¿Â¯1,1â€¿1âŸ©+<sand
    posâ†âŠ‘1âŠËœÂ¬belowâˆŠfull
    newâ†{pos=â‰ below?ğ•©;posâŠ‘below} sand
    (low<âŠ‘new)â—¶âŸ¨âŠ¢,sandâŸ© new
  } _fix sandstart
  fullâˆ¾Ëœ<new
}
â€¢Show 1-Ëœ(Drop _while_ {lowâ‰ âŠ‘âŠ‘ğ•©})âŠ¸(-â—‹â‰ ) rock
floorâ†2+low
Drop2â†{ğ•Š full:
    â€¢Show â‰ full
		newâ†{ğ•Š sand:
    belowâ†âŸ¨1â€¿0,1â€¿Â¯1,1â€¿1âŸ©+<sand
    posâ†âŠ‘1âŠËœÂ¬((floor=âŠ‘Â¨below)âˆ¨belowâˆŠfull)
    newâ†{pos=â‰ below?ğ•©;posâŠ‘below} sand
  } _fix sandstart
  fullâˆ¾Ëœ<new
}
â€¢Show (Drop2 _while_ {ğ•©(âŠ‘Â¬âˆ˜âˆŠ)Ëœ<0â€¿500})âŠ¸(-â—‹â‰ ) rock # Very slow
