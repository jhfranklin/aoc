#! /usr/bin/env bqn
âŸ¨SplitâŸ©â†â€¢Import "../bqn-libs/strings.bqn"
inâ†âˆ¾â€¢FLines â‰ â—¶"03.in"â€¿âŠ‘ â€¢args
GetGroupsâ†{
  mulâ†(â‰ ğ•©)â†‘"mul("â·ğ•© # Find the "mul(" starts
  gsâ†1â†“(+`mul) âŠ” ğ•©  # and collect them
  grpâ†{clsâ†âŠ‘ğ•©âŠ ')'  # locate the end of the groups
  (cls+1)â†‘ğ•©}Â¨gs
  grpâ†©(')'=âˆ¾Â¯1âŠ¸â†‘Â¨grp)/grp # remove groups that didn't end
}
IsNatâ†{(4>â‰ ğ•©)âˆ§âˆ§Â´ğ•©âˆŠ"0123456789"}
ParseNatâ†{IsNat ğ•©? â€¢ParseFloat ğ•© ; 0}
ParseMulâ†{{ğ•Š lâ€¿r:l Ã—â—‹ParseNat r;0}',' Split Â¯1â†“4â†“ğ•©}
â€¢Show (+Â´Â·ParseMulÂ¨GetGroups)in # Part 1
ProcessOnOffâ†{
onâ†(â‰ ğ•©)â†‘1âˆ¾"do()"â·ğ•©
offâ†(â‰ ğ•©)â†‘"don't()"â·ğ•©
mâ†(1âŒŠ0âŒˆ+)`on+-off
m/ğ•©
}
â€¢Show (+Â´Â·ParseMulÂ¨GetGroups)ProcessOnOff in # Part 2
