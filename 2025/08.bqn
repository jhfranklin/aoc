#! /usr/bin/env bqn
âŸ¨ToNatsâŸ©â†â€¢Import "../bqn-libs/strings.bqn"

bâ†ToNatsÂ¨ â€¢FLines "08.in"
pairsâ†âˆ¾(âŠ¢âˆ¾Â¨Â¨â‰ â†‘â†‘) idâ†â†•â‰ b
Distâ†{ğ•Š ğ•©:+Â´âŒ¾(Ã—Ëœ)-Â´ğ•©âŠb}
dsâ†DistÂ¨ pairs # distances
pairs â†© ds â’âŠ¸âŠ pairs # ordered pairs (descending for fold)
seenâ†0
Connectâ†{new ğ•Š circuit:
mâ†âˆ¨Â´Â¨+Ënew=âŒœcircuit
circuitâ†©{ğ•Š 0: # new circuit
circuitâˆ¾<new
;ğ•Š 1: # attach to existing circuit
(<(âˆ¾m/circuit)âˆ¾(Â¬newâˆŠâˆ¾circuit)/new)âˆ¾circuit/ËœÂ¬m
;ğ•Š 2: # merge circuits
(<âˆ¾m/circuit)âˆ¾circuit/ËœÂ¬m
}+Â´m
{seenâ†©1â‹„â€¢Show ğ•©âŠb}âŸ((Â¬seen)âˆ§(â‰ b)=â‰ âŠ‘circuit) new
circuit
}

â€¢Show Ã—Â´3â†‘âˆ¨â‰ Â¨âŸ¨âŸ© ConnectÂ´ Â¯1000â†‘pairs # Part 1
seenâ†©0
âŸ¨âŸ© ConnectÂ´ pairs # Part 2
