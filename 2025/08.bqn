#! /usr/bin/env bqn
âŸ¨ToNatsâŸ©â†â€¢Import "../bqn-libs/strings.bqn"
bâ†ToNatsÂ¨ â€¢FLines "08.in"

pairsâ†âˆ¾(âŠ¢âˆ¾Â¨Â¨â‰ â†‘â†‘) idâ†â†•â‰ b
Distâ†{+Â´âŒ¾(Ã—Ëœ)-Â´ğ•©âŠb}
dsâ†DistÂ¨ pairs # distances
pairs â†© ds â’âŠ¸âŠ pairs # ordered pairs (descending for fold)

Mergeâ†{ğ•Š pairs:
  seenâ†0
  p2â†âŸ¨âŸ©
  Câ†{new ğ•Š circuit:
    mâ†âˆ¨Â´Â¨+Ënew=âŒœcircuit
    circuitâ†©{
      ğ•Š 0: circuitâˆ¾<new;
      ğ•Š 1: (<(âˆ¾m/circuit)âˆ¾(Â¬newâˆŠâˆ¾circuit)/new)âˆ¾circuit/ËœÂ¬m;
      ğ•Š 2: (<âˆ¾m/circuit)âˆ¾circuit/ËœÂ¬m
    }+Â´m
    {seenâ†©1â‹„p2â†©ğ•©âŠb}âŸ((Â¬seen)âˆ§(â‰ b)=â‰ âŠ‘circuit) new
    circuit
  }
  p1â†âŸ¨âŸ© CÂ´ Â¯1000â†‘pairs
  p1 CÂ´ Â¯1000â†“pairs
  âŸ¨Ã—Â´3â†‘âˆ¨â‰ Â¨p1,âŠ‘Ã—Â´p2âŸ©
}

p1â€¿p2â†Merge pairs
â€¢Show p1 # Part 1
â€¢Show p2 # Part 2
