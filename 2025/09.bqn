#! /usr/bin/env bqn
âŸ¨ToNatsâŸ©â†â€¢Import "../bqn-libs/strings.bqn"
inâ†ToNatsÂ¨ â€¢FLines "09.in"
Aâ†Ã—Â´1+|âˆ˜-
pairsâ†(âŠ‘âŸœinÂ¨)Â¨âˆ¾(âŠ¢âˆ¾Â¨Â¨â‰ â†‘â†‘) â†•â‰ in
â€¢Show âŒˆÂ´AÂ´Â¨pairs # Part 1

edgesâ†2â†•inâˆ¾<âŠ‘in # all edges

scanlinesâ†{ğ•Š y:
  vedgesâ†âˆ§Ë˜(1â€¿0â‰¡â‰âˆâ€¿1=Â´Ë˜)âŠ¸/edges
  crossedâ†vedges/Ëœy{1=ğ•©âŒ½âŠ¸â’ğ•¨}Ë˜âŠ‘âˆ˜âŒ½Â¨vedges
  crossed (â†•0â€¿2)âŸ(0=â‰ )â†©
  [x1,y1]â†â‰(âŠ‘)Ë˜crossed
  [x2,y2]â†â‰(âŠ‘âŒ½)Ë˜crossed
  tâ†(y-y1)Ã·(y2-y1)
  xcrossâ†âˆ§x1+tÃ—x2-x1
}Â¨0.5+â†•1+âŒˆÂ´âŠ‘âˆ˜âŒ½Â¨in

P2Areaâ†{x1â€¿y1 ğ•Š x2â€¿y2:
  x1â€¿x2 â†© âˆ§ x1â€¿x2
  y1â€¿y2 â†© âˆ§ y1â€¿y2
  areaâ†(1+x2-x1)Ã—(1+y2-y1)
  areaÃ—âˆ§Â´{x3â€¿y3 ğ•Š x4â€¿y4:
  x3â€¿x4 â†© âˆ§ x3â€¿x4
  y3â€¿y4 â†© âˆ§ y3â€¿y4
  echeckâ†Â¬(x1<x4)âˆ§(x2>x3)âˆ§(y1<y4)âˆ§(y2>y3) # check not crossing an edge
  bâ†âŠ‘(x1+0.5)â‹Ëœ sâ†y1âŠ‘scanlines
  icheckâ†(b>0)âˆ§b<â‰ scanlines # check inside the polygon
  echeck âˆ§ icheck
}Â´Ë˜edges
}

â€¢Show âŒˆÂ´P2AreaÂ´Â¨ pairs #Â Part 2
